<section class="mb-5">

    <div class="row">
        <div class="col-12 col-lg-3">
            <div class="input-group">
                <input type="date" class="form-control" [(ngModel)]="dataProgramacao">
                <button class="btn btn-primary" (click)="consultarItensProgramadosAguardando()">
                    <i class="fas fa-search-dollar"></i>
                </button>
            </div>
        </div>
    </div>

    <div class="row ">
        <!-- TOTAL VALOR -->
        <div class="col-12">
            <div class="card-label d-flex between align-middle">
                <label class="color-text">VALOR TOTAL PROGRAMADO: </label>
                <label class="bold ms-2">{{totalGeral | currency: 'BRL'}}</label>
                <div class="text-end ms-4">
                    <i class="fas fa-exclamation-circle text-danger me-2"></i>
                    <label>ITEM CRÍTICO</label>
                    <i class="fas fa-exclamation text-primary ms-2 me-1"></i>
                    <label>PRIORIDADE ALTA</label>
                </div>
            </div>
        </div>

        <!-- CARD 1° TURNO -->
        <div class="col-12 col-lg-4 mt-1">
            <div class="cartao">
                <header class="header-cartao">
                    <label class="text-light bold">PRIMEIRO TURNO</label>
                </header>
                <div class="row p-2">
                    <div class="col-4">
                        <label class="mt-1 bold">LINHA</label>
                        <br>
                        <a class="c-pointer" *ngFor="let l of itensLinhaTurno1" class="sublinhado"
                            (click)="exibirItensProgramados(l)">
                            <label class=" mt-1 bold">{{l.linhaDeProducao.nome}}</label>
                            <br>
                        </a>
                    </div>
                    <div class="col-4">
                        <label class="bold">VALOR</label>
                        <br>
                        <div *ngFor="let linha of itensLinhaTurno1">
                            <label class="mt-1">{{linha.valorPrevisto | currency: 'BRL'}}</label>
                        </div>
                    </div>
                    <div class="col-2">
                        <div class="text-center">
                            <label class="bold">IMP</label>
                            <br>
                            <div *ngFor="let linha of itensLinhaTurno1" class="mt-1">
                                <a class="c-pointer" (click)="gerarPdfProgramacao(linha)">
                                    <i class="fas fa-print"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-2">
                        <div class="text-center">
                            <label class="bold">EXPORT</label>
                            <br>
                            <div *ngFor="let linha of itensLinhaTurno1" class="mt-1">
                                <a class="c-pointer" (click)="gerarExcel(linha)">
                                    <i class="fas fa-download text-success "></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <hr>
                        <div class="row">
                            <div class="col-5 bold">
                                TOTAL
                            </div>
                            <div class="col-5 bold">
                                {{totalTurno1 | currency: 'BRL'}}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- CARD 2° TURNO -->
        <div class="col-12 col-lg-4 mt-1">
            <div class="cartao">
                <header class="header-cartao">
                    <label class="text-light bold">SEGUNDO TURNO</label>
                </header>
                <div class="row p-2">
                    <div class="col-4">
                        <label class="mt-1 bold">LINHA</label>
                        <br>
                        <div *ngFor="let l of itensLinhaTurno2" class="sublinhado" (click)="exibirItensProgramados(l)">
                            <label class=" mt-1 bold">{{l.linhaDeProducao.nome}}</label>
                            <br>
                        </div>
                    </div>
                    <div class="col-4">
                        <label class="bold">VALOR</label>
                        <br>
                        <div *ngFor="let linha of itensLinhaTurno2">
                            <label class="mt-1">{{linha.valorPrevisto | currency: 'BRL'}}</label>
                        </div>
                    </div>
                    <div class="col-2">
                        <div class="text-center">
                            <label class="bold">IMP</label>
                            <br>
                            <div *ngFor="let linha of itensLinhaTurno2" class="mt-1">
                                <a class="c-pointer" (click)="gerarPdfProgramacao(linha)">
                                    <i class="fas fa-print"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-2">
                        <div class="text-center">
                            <label class="bold">EXPORT</label>
                            <br>
                            <div *ngFor="let linha of itensLinhaTurno2" class="mt-1">
                                <a class="c-pointer" (click)="gerarExcel(linha)">
                                    <i class="fas fa-download text-success "></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <hr>
                        <div class="row">
                            <div class="col-5 bold">
                                TOTAL
                            </div>
                            <div class="col-5 bold">
                                {{totalTurno2 | currency: 'BRL'}}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- CARD 3° TURNO -->
        <div class="col-12 col-lg-4 mt-1">
            <div class="cartao">
                <header class="header-cartao">
                    <label class="text-light bold">TERCEIRO TURNO</label>
                </header>
                <div class="row p-2">
                    <div class="col-4">
                        <label class="mt-1 bold">LINHA</label>
                        <br>
                        <div *ngFor="let l of itensLinhaTurno3" class="sublinhado" active
                            (click)="exibirItensProgramados(l)">
                            <label class=" mt-1 bold">{{l.linhaDeProducao.nome}}</label>
                            <br>
                        </div>
                    </div>
                    <div class="col-4">
                        <label class="bold">VALOR</label>
                        <br>
                        <div *ngFor="let linha of itensLinhaTurno3">
                            <label class="mt-1">{{linha.valorPrevisto | currency: 'BRL'}}</label>
                        </div>
                    </div>
                    <div class="col-2">
                        <div class="text-center">
                            <label class="bold">IMP</label>
                            <br>
                            <div *ngFor="let linha of itensLinhaTurno3" class="mt-1">
                                <a class="c-pointer" (click)="gerarPdfProgramacao(linha)">
                                    <i class="fas fa-print"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-2">
                        <div class="text-center">
                            <label class="bold">EXPORT</label>
                            <br>
                            <div *ngFor="let linha of itensLinhaTurno3" class="mt-1">
                                <a class="c-pointer" (click)="gerarExcel(linha)">
                                    <i class="fas fa-download text-success "></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <hr>
                        <div class="row">
                            <div class="col-5 bold">
                                TOTAL
                            </div>
                            <div class="col-5 bold">
                                {{totalTurno3 | currency: 'BRL'}}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <section *ngIf="sequenciaSetup.length > 0">
        <div class="col-12 mt-3">
            <div class="card-label align-middle text-center">
                <label class="color-text">VISUALIZAÇÃO DOS ITENS PROGRAMADOS </label>
                <label class="bold ms-2">{{nomeLinhaVisualizacao}} - {{turnoVisualizacao}}</label>
            </div>
        </div>
        <div class="cards" *ngFor="let st of sequenciaSetup" (click)="criarSetup(st.setup)"
            id="{{st.nomeBeneficiamento}}">
            <div class="card-header c-pointer" (click)="setStep(st.nomeBeneficiamento)">
                <div class="card-header-config">
                    <div class="titulo">
                        <label class="bold c-pointer" *ngIf="st.sequenciaSetup != 0">{{st.sequenciaSetup}}-</label>
                        <label class="bold c-pointer" *ngIf="st.setup == 0"> SETUP MISTO</label>
                        <label class="bold c-pointer" *ngIf="st.setup != 0">{{st.nomeBeneficiamento}}</label>
                    </div>
                </div>
            </div>
            <div class="botao">
                <button class="btn btn-primary  btn-sm " (click)="alterarSetup(st)">Alterar
                    sequência</button>
                <button class="btn btn-danger   btn-sm ms-1" (click)="excluirSetup(st.itensProgramados)">Excluir
                    setup</button>
            </div>
        </div>
        <div>
            <div class="card-body mat-expansion-panel" *ngIf="listaSetup.length > 0">
                <table class="table table-striped table-sm font-11 table-hover " matSort *ngIf="listaSetup.length > 0"
                    (matSortChange)="sort($event)">
                    <thead>
                        <tr>
                            <th>SEQ.</th>
                            <th>PRIO.</th>
                            <th scope="col" class="color-text" mat-sort-header="cdEntrada">CONTROLE</th>
                            <th scope="col" class="color-text" mat-sort-header="item">ITEM</th>
                            <th scope="col" class="color-text" mat-sort-header="nomeCliente">CLIENTE</th>
                            <th scope="col" class="color-text" mat-sort-header="nomeProduto">PRODUTO</th>
                            <th scope="col" class="color-text" mat-sort-header="espessura">ESP.</th>
                            <th scope="col" class="color-text" mat-sort-header="nomeBeneficiamento">BENEFICIAMENTO
                            </th>
                            <th scope="col" class="color-text text-center" mat-sort-header="quantidade">QTDE</th>
                            <th scope="col" class="color-text text-center" mat-sort-header="status">SITUAÇÃO</th>
                            <th scope="col" class="color-text text-center">CONFIG</th>
                            <th scope="col" class="color-text text-center">OBS.APONT</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let produto of listaSetup">
                            <td class="c-pointer" (click)="visualizarDetalhesDoItem(produto)">
                                {{produto.sequencia}}
                            </td>
                            <td (click)="visualizarDetalhesDoItem(produto)">
                                <div class="d-inline-flex justify-content-between">
                                    <i id="fa-comment-alt" class="fas fa-comment-alt pisca text-success me-1" *ngIf="produto.observacao"></i>
                                    <i class="fas fa-exclamation-circle text-danger" *ngIf="produto.prioridade == 0"></i>
                                    <i class="fas fa-exclamation text-primary" *ngIf="produto.prioridade == 1"></i>
                                </div>
                            </td>
                            <td class="c-pointer" (click)="visualizarDetalhesDoItem(produto)">
                                {{produto.cdEntrada}}
                            </td>
                            <td class="c-pointer" (click)="visualizarDetalhesDoItem(produto)">{{produto.item}}
                            </td>
                            <td class="c-pointer" (click)="visualizarDetalhesDoItem(produto)">
                                {{produto.nomeCliente}}</td>
                            <td class="c-pointer" (click)="visualizarDetalhesDoItem(produto)">
                                {{produto.nomeProduto}}</td>
                            <td class="c-pointer" (click)="visualizarDetalhesDoItem(produto)">
                                {{produto.espessura}}
                            </td>
                            <td class="c-pointer" (click)="visualizarDetalhesDoItem(produto)">
                                {{produto.nomeBeneficiamento}}</td>
                            <td class="c-pointer" (click)="visualizarDetalhesDoItem(produto)">
                                {{produto.qtdeProgramada}}</td>
                            <td class="c-pointer" (click)="visualizarDetalhesDoItem(produto)">{{produto.status}}
                            </td>
                            <td class="text-center c-pointer">
                                <a class="text-danger c-pointer" *ngIf="produto.status == 'AGUARDANDO'"
                                    (click)="iniciarProgramacao(produto)"><i class="fas fa-stop"></i></a>
                                <a class="text-success c-pointer" *ngIf="produto.status == 'PRODUZINDO'"
                                    (click)="finalizaProgramacao(produto)"><i class="fas fa-play"></i></a>
                                <i class="fas fa-check-double text-success" *ngIf="produto.status == 'FINALIZADO'"></i>
                                <div>
                                    <label class="d-block c-pointer text-truncate" style="max-width: 200px;"
                                        data-bs-toggle="tooltip" data-bs-placement="top"
                                        title="Item bloqueado clique no bolão a direita e veja o responsavel por programar para desbloquear"><i
                                            class="fas fa-ban text-danger" *ngIf="produto.status == 'BLOQUEADO'"
                                            (click)="iniciarProgramacao(produto)"></i></label>
                                </div>
                            </td>
                            <td scope="col" class="color-text text-center c-pointer" (click)="openObservacoes(produto)">
                                <label><i class="fas fa-comment-medical text-danger"
                                        *ngIf="produto.status == 'BLOQUEADO'"></i></label>
                                <label><i class="fas fa-comment-medical"
                                        *ngIf="produto.status != 'FINALIZADO'  && produto.observacoes.length <= 0 && produto.status != 'BLOQUEADO'"></i></label>
                                <label><i class="fas fa-comment-medical text-success"
                                        *ngIf="produto.status == 'FINALIZADO' && produto.observacoes.length > 0 && produto.status != 'BLOQUEADO'"></i></label>
                                <label><i class="fas fa-comment-medical"
                                        *ngIf="produto.status == 'FINALIZADO'  && produto.observacoes.length <= 0"></i></label>
                                <label><i class="fas fa-comment-medical text-success"
                                        *ngIf="produto.status != 'FINALIZADO'  && produto.observacoes.length > 0 && produto.status != 'BLOQUEADO'"></i></label>
                            </td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <td>TOTAIS</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td>{{totalTbQtde}}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tfoot>

                </table>
                <div class="d-flex align-items-center justify-content-start p-1">
                    <button class="btn btn-sm btn-danger" (click)="alterarTodos(listaSetup)">Alterar Todos
                        itens</button>
                </div>
            </div>
        </div>

    </section>
</section>